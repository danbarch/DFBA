
dfba_phi {DFBA}					R Documentation

Bayesian Distribution-Free Correlation and Concordance

Description

Given bivariate data, this function computes the sample number 
of concordant changes nc between the two variates and the number 
of discordant changes nd. The program provides the frequentist 
Kendall tau_A correlation coefficient, which is equal to 
(nc-nd)/(nc+nd), and the program also provides a Bayesian analysis 
of the population concordance parameter phi, which is the limit 
of the proportion of concordance changes between the variates. 
For goodness-of-fit applications, where the values for one of the 
variates are scores from a predictive model with free fitting 
parameters, the function provides a concordance measure for the
goodness-of-fit that corrects for the number of fitting 
parameters.

Usage

dfba_phi(
  x,
  y,
  a.prior = 1,
  b.prior = 1,
  interval.width = 0.95,
  fitting.parameters = NULL
)

Arguments

x			Vector of x variable values

y			Vector of y variable values

a.prior			First shape parameter for the prior beta 
			distribution (default is 1)

b.prior			Second shape parameter for the prior 
			beta distribution (default is 1)

interval.width		Desired width for interval estimates 
			(default is .95)

fitting.parameters	(Optional) If either x or y values are 
			generated by a predictive model, the
			number of free parameters in the model
			(default is NULL)

Details

The Pearson product-moment correlation depends on Gaussian 
assumptions about the residuals in a regression analysis. It 
is not robust because it is strongly influenced by any extreme 
outlier scores for either variates. A rank-based analysis can 
avoid both of these limitations. The dfba_phi () program is 
focused on a nonparametric concordance metric for characterizing 
the association between the two bivariate measures. 

To illustrate the nonparametric concepts of concordance and 
discordance, consider a specific example where there are five
paired scores with the x measure being 3.8, 4.7,4.7,4.7,11.8, 
and the corresponding y values are 5.9,-4.1,7.3,7.3,38.9. The 
ranks for the x variate are 1,3,3,3,5 and the corresponding ranks 
for y are 2,1,3.5,3.5,5, so the five points in terms of their ranks
are P1=(1,2), P2=(3,1), P3=(3,3.5), P4=(3,3.5) and P5=(5,5). 
The relationship between any two of these points, say in general,
points Pi and Pj, is either (1) concordant if the sign of Rxi-Rxj
is the same as the sign of Ryi-Ryj,(2) discordant if signs are 
different between Rxi-Rxj and Ryi-Ryj, or (3) null if either
Rxi=Rxj or if Ryi=Ryj. For the above example there are ten 
possible comparisons among the five points; six are concordant,
one is discordant, and there are three lost comparisons due to
ties. In general given n bivariate scores there are n(n-1)/2 
total possible comparisons but when there are ties in the x
variate there is a loss of Tx comparisons, and when there are ties in
the y variate there are Ty lost comparisons; however the total 
lost comparisons due to ties is Tx+Ty-Txy where Txy are the 
comparisons already previously counted because both the x and y 
variates were tied. Consequently, the number of comparisons is
[n*(n-1)/2]-Tx-Ty+Txy. In the above example there are three lost
comparisons due to ties in x, one lost comparison due to a tie in y, 
and one comparison where both the x and y variates are tied so the 
substraction of Tx and Ty doubly counted that comparison. Thus 
there are [(5*4)/2]-3-1+1=7 comparisons for the above example. 
The Kendall tau_A correlation is defined as (nc-nd)/(nc+nd), which 
is a value on the [-1,1] interval. However, it is important to note 
that Kendall used a different coefficient that has come to be called 
tau_B, which is
(nc-nd)/{[(n*(n-1)/2)-Tx][(n*(n-1)/2)-Ty]}^.5. However, tau_B 
does not properly correct for tied scores, which is unfortunate
because tau_B is the value used by base R with the command
cor(x,y,method="kendall"). If there are no ties, then Tx=Ty=Txy=0 and
tau_A=tau_B. But if there are ties, then the proper coefficient 
should be tau_A. The dfba_phi() program provides the proper 
correction for tied scores and outputs a sample estimate for 
tau_A. 

The focus for the Bayesian analysis is on the population proportion
of concordance, which is the limit of the ratio nc/(nc+nd). This
proportion is a value on the [0,1] interval, and it is called phi. 
Phi is also connected to the population tau_A because 
tau_A=(2*phi -1). Moreover, Chechile (2020) showed that the 
likelihood function for observing nc concordant changes and nd 
discordant changes is a censored Bernoulli process, so the 
likelihood is proportional to (phi^nc)*((1-phi)^nd). In Bayesian 
statistics the likelihood function is only specified as a 
proportional function because, unlike frequentist statistics, the 
likelihood of unobserved and more extreme events are not computed. 
This idea is the likelihood principle, and its violation can lead 
to paradoxes (Lindley & Phillips, 1976). Also the likelihood need 
only be a proportional function because the proportionality 
constant appears in both the numerator and denominator of Bayes 
theorem, so it cancels out. If the prior for phi is a beta 
distribution, then it follows that the posterior is also a beta 
distribution (i.e., the beta is a natural Bayesian conjugate 
function for Bernoulli processes). The default prior for the 
dfba_phi() program is the flat prior (i.e., a.prior=1 and
b.prior=1), but the user can adjust those values.

In the special case where the user has a model for predicting 
a variate in terms of known quantities and where there
are free-fitting parameters, the dfba_phi() program's concordance 
parameter is a goodness-of-fit measure for the scientific model.
Thus the bivariate pair are the observed value of a variate along
with the corresponding predicted score. However, the concordance 
proportion must be adjusted in these goodness-of-fit applications 
to take into account the number of free parameters that were used 
in the prediction model. Chechile and Barch (2021) argued that the 
fitting parameters increases the number of concordant changes. 
Consequently the value for nc is downward adjusted as a function of
the number of free parameters. The Chechile-Barch adjusted nc value 
for a case where there are m free fitting parameter is
 nc-(n*m)+[m*(m+1)/2]. As an example, suppose that there are n=20 
scores, and the prediction equation has m=2 free parameters that 
result is creating a prediction for each observed score 
(i.e., there are 20 pairs x=obs_score, y=pred_score),
and suppose that this model results in nc=170 and nd=20. The value 
of nd is kept at 20, but the number of concordant changes is reduced 
to 170-(20*2)+(2*3/2), which is equal to 133. 
   


Value

A list containing the following components:

tau		Nonparametric Kendall Tau-A correlation

sample.p		Sample concordance proportion

nc		Number of concordant comparisons

nd		Number of discordant comparisons

a.post		The first shape parameter for the 
		posterior beta distribution for the
		concordance proportion

b.post 		The second shape parameter for the
		posterior beta distribution for the
		concordance proportion

a.prior		The first shape parameter for the
		prior beta distribution for the 
		concordance proportion

b.prior		The second shape parameter for the
		prior beta distribution for the
		concordance proportion

interval_width	The probability within the interval 
		estimates for the phi parameter

post.median	Median of posterior distribution on phi

post.eti.lower	Lower limit of the equal-tail interval with 
		width specified by interval.width

post.eti.upper	Upper limit of the equal-tail interval with 
		width specified by interval.width

tau_star		Corrected Kendall tau_A to account for the
		number of free fitting parameter in goodness-
		of-fit applications

nc_star		The corrected number of concordant comparisons
		for a goodness-of-fit application when there 
		is an integer value for 'fitting.parameters'

nd_star		The number of discordant comparison when there
		is an integer value for 'fitting.parameters'

sample.p_star	Correct proportion of concordant comparisons
		to account for free-fitting parameter for
		goodness-of-fit applications

a.post_star	Corrected value for the first shape parameter
		for the posterior for the concordance proportion
		when there are free fitting parameter for 
		goodness-of-fit applications

b.post_star	The second shape parameter for the posterior
		distribution for the concordance proportion
		when there is a goodness-of-fit application

post.median_star	The posterior median for the concordance 
		proportion when there is a goodness-of-fit
		application

post.eti.lower_star	Lower limit for the interval estimate
			when there is a goodness-of-fit
			application

post.eti.upper_star	Upper limt for the interval estimate
			when there is a goodness-of-fit
			application			 



References

Chechile, R.A. (2020). Bayesian Statistics for Experimental 
Scientists: A General Introduction Using Distribution_Free
Statistics. Cambridge: MIT Press.

Chechile, R.A., & Barch, D.H. (2021). A distribution-free, 
Bayesian goodness-of-fit method for assessing similar scientific 
prediction equations. Journal of Mathematical Psychology. 
https://doi.org/10.1016/j.jmp.2021.102638

Lindley, D. V., & Phillips, L. D. (1976). Inference for a  
Bernoulli process (a Bayesian view). The American Statistics, 30, 
112-119.

Examples

## Example from the 1961 study by Clark, Vandenberg, and Proctor
# of twins in Human Biology, 33, 163-180.
maletwin1<-c(45,40,48,42,45,44,40,37,27,45,51,44,44,29,27,48, 
 33,39,47,54,32)
maletwin2<-c(37,41,50,46,31,39,37,42,27,48,49,52,27,36,29,44, 
 44,43,34,48,33)
dfba_phi(x=maletwin1,y=maletwin2)

## A goodness-of-fit example for a hypothetical case of 
# fitting data in a yobs vector with prediction model where 
p=seq(.05,.95,.05)
ypred=17.332-(50.261*p)+(48.308*p*p)
# Note the coefficients in the ypred equation were found first
# via a polynomial regression
yobs<-c(19.805,10.105,9.396,8.219,6.110,4.543,5.864,4.861,
 6.136,5.789,5.443,5.548,4.746,6.484,6.185,6.202,9.804,9.332,
 14.408)
dfba_phi(x=yobs,y=ypred,fitting.parameters=3)



